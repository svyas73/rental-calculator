<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
    <title>Rental Property Investment Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Download libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-home"></i> Rental Property Investment Calculator</h1>
            <p>Comprehensive analysis tool for real estate investment decisions</p>
            <!-- Mobile Quick Actions -->
            <div class="mobile-quick-actions" id="mobileQuickActions" style="display: none;">
                <button class="quick-action-btn" onclick="document.getElementById('calculateBtn').click()">
                    <i class="fas fa-calculator"></i> Calculate
                </button>
                <button class="quick-action-btn" onclick="document.getElementById('resultsSection').scrollIntoView({behavior: 'smooth'})">
                    <i class="fas fa-chart-bar"></i> Results
                </button>
            </div>
        </header>

        <div class="main-content">
            <!-- Input Section -->
            <div class="input-section" id="inputSection">
                <div class="form-container">
                    <div class="form-header">
                        <h2>Property Details</h2>
                        <button id="toggleInputsBtn" class="toggle-btn" title="Minimize/Maximize Input Section">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                    </div>
                    <!-- Property Information -->
                    <div class="form-group">
                        <h3>Property Information</h3>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="propertyPrice">Purchase Price ($)</label>
                                <input type="number" id="propertyPrice" value="300000" min="0" step="1000" required>
                                <div class="error-message" id="propertyPrice-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="propertyType">Property Type</label>
                                <select id="propertyType" required>
                                    <option value="single-family">Single Family</option>
                                    <option value="multi-family">Multi-Family</option>
                                    <option value="condo">Condo</option>
                                    <option value="townhouse">Townhouse</option>
                                    <option value="commercial">Commercial</option>
                                </select>
                                <div class="error-message" id="propertyType-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="squareFootage">Square Footage</label>
                                <input type="number" id="squareFootage" value="1500" min="0" step="50" required>
                                <div class="error-message" id="squareFootage-error"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="propertyAddress">Property Address</label>
                                <input type="text" id="propertyAddress" placeholder="123 Main St, City, State ZIP" required>
                                <div class="error-message" id="propertyAddress-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="purchaseMonth">Purchase Month</label>
                                <select id="purchaseMonth" required>
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                                <div class="error-message" id="purchaseMonth-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="purchaseYear">Purchase Year</label>
                                <input type="number" id="purchaseYear" value="2024" min="1990" max="2030" required>
                                <div class="error-message" id="purchaseYear-error"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Financing Details -->
                    <div class="form-group">
                        <h3>Financing Details</h3>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="downPayment">Down Payment ($)</label>
                                <input type="number" id="downPayment" value="60000" min="0" step="1000" required>
                                <div class="error-message" id="downPayment-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="downPaymentPercent">Down Payment (%)</label>
                                <input type="number" id="downPaymentPercent" value="20" min="0" max="100" step="0.1" required>
                                <div class="error-message" id="downPaymentPercent-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="loanAmount">Loan Amount ($)</label>
                                <input type="number" id="loanAmount" value="240000" min="0" step="1000" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="interestRate">Interest Rate (%)</label>
                                <input type="number" id="interestRate" value="4.5" min="0" max="20" step="0.01" required>
                                <div class="error-message" id="interestRate-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="loanTerm">Loan Term (Years)</label>
                                <select id="loanTerm" required>
                                    <option value="15">15 Years</option>
                                    <option value="20">20 Years</option>
                                    <option value="30" selected>30 Years</option>
                                </select>
                                <div class="error-message" id="loanTerm-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="monthlyPayment">Monthly Payment ($)</label>
                                <input type="number" id="monthlyPayment" value="1216" min="0" step="1" readonly>
                            </div>
                        </div>
                    </div>
                    <!-- Rental Income -->
                    <div class="form-group">
                        <h3>Rental Income</h3>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="monthlyRent">Monthly Rent ($)</label>
                                <input type="number" id="monthlyRent" value="2000" min="0" step="50" required>
                                <div class="error-message" id="monthlyRent-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="rentGrowthRate">Annual Rent Growth Rate (%)</label>
                                <input type="number" id="rentGrowthRate" value="3" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="rentGrowthRate-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="vacancyRate">Vacancy Rate (%)</label>
                                <input type="number" id="vacancyRate" value="5" min="0" max="50" step="0.1" required>
                                <div class="error-message" id="vacancyRate-error"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Operating Expenses -->
                    <div class="form-group">
                        <h3>Operating Expenses</h3>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="propertyTax">Annual Property Tax ($)</label>
                                <input type="number" id="propertyTax" value="3600" min="0" step="100" required>
                                <div class="error-message" id="propertyTax-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="insurance">Annual Insurance ($)</label>
                                <input type="number" id="insurance" value="1200" min="0" step="100" required>
                                <div class="error-message" id="insurance-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="hoaFees">Monthly HOA Fees ($)</label>
                                <input type="number" id="hoaFees" value="0" min="0" step="10" required>
                                <div class="error-message" id="hoaFees-error"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="utilities">Monthly Utilities ($)</label>
                                <input type="number" id="utilities" value="200" min="0" step="10" required>
                                <div class="error-message" id="utilities-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="maintenance">Monthly Maintenance ($)</label>
                                <input type="number" id="maintenance" value="150" min="0" step="10" required>
                                <div class="error-message" id="maintenance-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="propertyManagement">Property Management Fee (%)</label>
                                <input type="number" id="propertyManagement" value="0" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="propertyManagement-error"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="depreciationMethod">Depreciation Method</label>
                                <select id="depreciationMethod" required>
                                    <option value="straight-line">Straight-Line (27.5 years)</option>
                                    <option value="accelerated">Accelerated (MACRS)</option>
                                    <option value="none">No Depreciation</option>
                                </select>
                                <div class="error-message" id="depreciationMethod-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="depreciationPeriod">Depreciation Period (Years)</label>
                                <input type="number" id="depreciationPeriod" value="27.5" min="1" max="50" step="0.5" required>
                                <div class="error-message" id="depreciationPeriod-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="landValue">Land Value ($)</label>
                                <input type="number" id="landValue" value="60000" min="0" step="1000" required>
                                <div class="error-message" id="landValue-error"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Investment Parameters -->
                    <div class="form-group">
                        <h3>Investment Parameters</h3>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="analysisPeriod">Analysis Period (Years)</label>
                                <input type="number" id="analysisPeriod" value="15" min="1" max="30" step="1" required>
                                <div class="error-message" id="analysisPeriod-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="appreciationRate">Annual Appreciation Rate (%)</label>
                                <input type="number" id="appreciationRate" value="3" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="appreciationRate-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="sellingCosts">Selling Costs (%)</label>
                                <input type="number" id="sellingCosts" value="6" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="sellingCosts-error"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-field">
                                <label for="taxRate">Tax Rate (%)</label>
                                <input type="number" id="taxRate" value="25" min="0" max="50" step="0.1" required>
                                <div class="error-message" id="taxRate-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="inflationRate">Inflation Rate (%)</label>
                                <input type="number" id="inflationRate" value="2" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="inflationRate-error"></div>
                            </div>
                            <div class="form-field">
                                <label for="discountRate">Discount Rate (%)</label>
                                                                 <input type="number" id="discountRate" value="0" min="0" max="20" step="0.1" required>
                                <div class="error-message" id="discountRate-error"></div>
                            </div>
                        </div>
                    </div>
                    <button id="calculateBtn" class="calculate-btn">
                        <i class="fas fa-calculator"></i> Calculate Investment Analysis
                    </button>
                </div>
            </div>
            <!-- Results Section -->
            <div class="results-section" id="resultsSection" style="display: none;">
                <div class="results-container">
                    <!-- Property Header Section -->
                    <div class="property-header" id="propertyHeader">
                        <div class="property-info">
                            <div class="property-image-container">
                                <img id="propertyImage" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMDAgNzVDMTA4LjI4NCA3NSAxMTUgNjguMjg0MyAxMTUgNjBDMTE1IDUxLjcxNTcgMTA4LjI4NCA0NSAxMDAgNDVDOTEuNzE1NyA0NSA4NSA1MS43MTU3IDg1IDYwQzg1IDY4LjI4NDMgOTEuNzE1NyA3NSAxMDAgNzVaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xMDAgODVDMTA4LjI4NCA4NSAxMTUgNzguMjg0MyAxMTUgNzBDMTE1IDYxLjcxNTcgMTA4LjI4NCA1NSAxMDAgNTVDOTEuNzE1NyA1NSA4NSA2MS43MTU3IDg1IDcwQzg1IDc4LjI4NDMgOTEuNzE1NyA4NSAxMDAgODVaIiBmaWxsPSIjOUI5QkEwIi8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUI5QkEwIiBmb250LWZhbWlseT0iSW50ZXIiIGZvbnQtc2l6ZT0iMTIiPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4K" alt="Property Image" class="property-image">
                                <div class="image-loading" id="imageLoading" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                            </div>
                            <div class="property-details">
                                <h3 id="propertyAddressDisplay">Property Address</h3>
                                <p class="purchase-date" id="purchaseDate">Purchase Date: <span id="purchaseDateValue">Not specified</span></p>
                                <div class="property-links">
                                    <a href="#" id="zillowLink" class="property-link" target="_blank" rel="noopener">
                                        <i class="fas fa-home"></i> Zillow
                                    </a>
                                    <a href="#" id="redfinLink" class="property-link" target="_blank" rel="noopener">
                                        <i class="fas fa-search"></i> Redfin
                                    </a>
                                    <a href="#" id="googleMapsLink" class="property-link" target="_blank" rel="noopener">
                                        <i class="fas fa-map-marker-alt"></i> Google Maps
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-header">
                        <h2>Investment Analysis Results</h2>
                        <div class="download-buttons">
                            <button id="downloadExcelBtn" class="download-btn" title="Download Complete Report as Excel">
                                <i class="fas fa-file-excel"></i> Download Excel Report
                            </button>
                            <button id="downloadPdfBtn" class="download-btn" title="Download Complete Report as PDF">
                                <i class="fas fa-file-pdf"></i> Download PDF Report
                            </button>
                        </div>
                    </div>
                    <!-- Summary Cards -->
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="card-content">
                                <h3>Total Capital Gain</h3>
                                <div class="card-value" id="cashOnCashROI">-</div>
                                <div class="card-label">Sale Proceeds - Initial Investment</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-percentage"></i></div>
                            <div class="card-content">
                                <h3>IRR</h3>
                                <div class="card-value" id="irrValue">-</div>
                                <div class="card-label">Internal Rate of Return</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-dollar-sign"></i></div>
                            <div class="card-content">
                                <h3>Net Present Value</h3>
                                <div class="card-value" id="npvValue">-</div>
                                <div class="card-label">NPV</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-calendar-alt"></i></div>
                            <div class="card-content">
                                <h3>Break-Even</h3>
                                <div class="card-value" id="breakEvenYears">-</div>
                                <div class="card-label">Years</div>
                            </div>
                        </div>
                    </div>
                    <!-- Monthly Cash Flow -->
                    <div class="result-group">
                        <h3>Monthly Cash Flow Analysis</h3>
                        <div class="cash-flow-grid">
                            <div class="cash-flow-item">
                                <span class="label">Gross Monthly Rent:</span>
                                <span class="value" id="grossMonthlyRent">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Vacancy Loss:</span>
                                <span class="value negative" id="vacancyLoss">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Effective Gross Income:</span>
                                <span class="value" id="effectiveGrossIncome">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Operating Expenses:</span>
                                <span class="value negative" id="operatingExpenses">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Net Operating Income:</span>
                                <span class="value" id="netOperatingIncome">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Debt Service:</span>
                                <span class="value negative" id="debtService">-</span>
                            </div>
                            <div class="cash-flow-item">
                                <span class="label">Monthly Depreciation:</span>
                                <span class="value" id="monthlyDepreciation">-</span>
                            </div>
                            <div class="cash-flow-item total">
                                <span class="label">Monthly Cash Flow:</span>
                                <span class="value" id="monthlyCashFlow">-</span>
                            </div>
                        </div>
                    </div>
                                         <!-- Yearly Returns Table -->
                     <div class="result-group">
                         <div class="table-header">
                             <h3>Yearly Returns Analysis <span id="analysisPeriodDisplay" style="font-size: 0.8em; color: #718096; font-weight: normal;">(15 years)</span></h3>
                             <div class="download-buttons">
                                 <button id="downloadRoiExcelBtn" class="download-btn" title="Download ROI Data as Excel">
                                     <i class="fas fa-file-excel"></i> Export ROI Excel
                                 </button>
                                 <button id="downloadRoiPdfBtn" class="download-btn" title="Download ROI Data as PDF">
                                     <i class="fas fa-file-pdf"></i> Export ROI PDF
                                 </button>
                             </div>
                         </div>
                         <div class="table-container">
                            <table class="returns-table" id="returnsTable">
                                <thead>
                                    <tr>
                                        <th title="Analysis Year (1, 2, 3, etc.)"><div class="header-label">A</div><div class="header-name">Year</div></th>
                                        <th title="Month and Year format (e.g., Aug/2026)"><div class="header-label">B</div><div class="header-name">Month/Year</div></th>
                                        <th title="Actual Calendar Year"><div class="header-label">C</div><div class="header-name">Actual Year</div></th>
                                        <th title="Previous Value × (1 + Appreciation Rate)"><div class="header-label">D</div><div class="header-name">Property Value</div></th>
                                        <th title="Monthly Rent × 12 × (1 + Rent Growth Rate)^Year"><div class="header-label">E</div><div class="header-name">Annual Rent</div></th>
                                        <th title="Property Tax + Insurance + HOA + Utilities + Maintenance + Management Fee"><div class="header-label">F</div><div class="header-name">Operating Expenses</div></th>
                                        <th title="Annual Rent - Operating Expenses"><div class="header-label">G</div><div class="header-name">Net Operating Income</div></th>
                                        <th title="Monthly Payment × 12"><div class="header-label">H</div><div class="header-name">Total Mortgage Payment</div></th>
                                        <th title="Total Mortgage Payment - Principal Paid"><div class="header-label">I</div><div class="header-name">Interest Payment</div></th>
                                        <th title="Annual Principal Component of Mortgage"><div class="header-label">J</div><div class="header-name">Principal Paid</div></th>
                                        <th title="Net Operating Income - Total Mortgage Payment"><div class="header-label">K</div><div class="header-name">Net Cash Flow</div></th>
                                        <th title="Net Cash Flow + Principal Paid"><div class="header-label">L</div><div class="header-name">Taxable Cash Flow</div></th>
                                        <th title="(Property Value - Land Value) ÷ Depreciation Period"><div class="header-label">M</div><div class="header-name">Depreciation</div></th>
                                        <th title="min(Taxable Cash Flow, Depreciation) × Tax Rate"><div class="header-label">N</div><div class="header-name">Tax Savings</div></th>
                                        <th title="Unused Depreciation carried forward to next year"><div class="header-label">O</div><div class="header-name">Unclaimed Depreciation</div></th>
                                        <th title="Net Cash Flow + Tax Savings"><div class="header-label">P</div><div class="header-name">Total Cash Flow (for ROI)</div></th>
                                        <th title="(Total Cash Flow ÷ Down Payment) × 100"><div class="header-label">Q</div><div class="header-name">ROI (%)</div></th>
                                    </tr>
                                </thead>
                                <tbody id="returnsTableBody">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- IRR Analysis -->
                    <div class="result-group">
                        <h3>IRR Analysis</h3>
                        <div class="irr-analysis">
                            <div class="irr-chart-container">
                                <canvas id="irrChart" width="900" height="500"></canvas>
                            </div>
                            <div class="irr-details">
                                <div class="irr-item">
                                    <span class="label">Initial Investment:</span>
                                    <span class="value" id="initialInvestment">-</span>
                                </div>
                                <div class="irr-item">
                                    <span class="label">Holding Period:</span>
                                    <span class="value" id="holdingPeriod">-</span>
                                </div>
                                <div class="irr-item">
                                    <span class="label">Total Cash Flow:</span>
                                    <span class="value" id="totalCashFlow">-</span>
                                </div>
                                <div class="irr-item">
                                    <span class="label">Capital Gain:</span>
                                    <span class="value" id="saleProceeds">-</span>
                                </div>
                                <div class="irr-item">
                                    <span class="label">IRR:</span>
                                    <span class="value highlight" id="irrFinal">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Sensitivity Analysis -->
                    <div class="result-group">
                        <h3>Sensitivity Analysis</h3>
                        <div class="sensitivity-grid">
                            <div class="sensitivity-item">
                                <h4>Rent Variation Impact</h4>
                                <div class="sensitivity-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Rent Change</th>
                                                <th>Cash Flow</th>
                                                <th>Total Capital Gain</th>
                                                <th>IRR</th>
                                            </tr>
                                        </thead>
                                        <tbody id="rentSensitivityBody">
                                            <!-- Data will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="sensitivity-item">
                                <h4>Appreciation Impact</h4>
                                <div class="sensitivity-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Appreciation</th>
                                                <th>Property Value</th>
                                                <th>Total Return</th>
                                                <th>IRR</th>
                                            </tr>
                                        </thead>
                                        <tbody id="appreciationSensitivityBody">
                                            <!-- Data will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
            <script src="script.js?v=1.22"></script>
</body>
</html> 